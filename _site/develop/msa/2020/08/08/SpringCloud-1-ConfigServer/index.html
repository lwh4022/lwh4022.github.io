<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>
      Maymanko&#39;s blog
    </title>
    <link rel="shortcut icon" type="image/x-icon" href="/assets/images/favicon.ico">
    <link rel="stylesheet" href="/assets/css/materialize.min.css" media="screen,projection">
    <link rel="stylesheet" href="//fonts.googleapis.com/icon?family=Material+Icons">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/assets/css/main.css">
    
      
        <link rel="stylesheet" href="/assets/css/post.css">
      
      
      
    <link rel="stylesheet" href="/assets/css/syntax.css">
    <link rel="sitemap" type="application/xml" title="Sitemap" href="/sitemap.xml">
    <link rel="stylesheet" href="/assets/css/github-markdown.css">
    <link rel="stylesheet" href="/assets/css/custom.css">
    <!-- Begin Jekyll SEO tag v2.6.1 -->
<meta name="generator" content="Jekyll v3.8.6" />
<meta property="og:title" content="스프링 클라우드 / Config-Server" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="스프링 마이크로 서비스 코딩 공작소" />
<meta property="og:description" content="스프링 마이크로 서비스 코딩 공작소" />
<link rel="canonical" href="http://localhost:4000/develop/msa/2020/08/08/SpringCloud-1-ConfigServer/" />
<meta property="og:url" content="http://localhost:4000/develop/msa/2020/08/08/SpringCloud-1-ConfigServer/" />
<meta property="og:site_name" content="Maymanko’s blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-08-08T00:00:00+09:00" />
<script type="application/ld+json">
{"@type":"BlogPosting","datePublished":"2020-08-08T00:00:00+09:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/develop/msa/2020/08/08/SpringCloud-1-ConfigServer/"},"url":"http://localhost:4000/develop/msa/2020/08/08/SpringCloud-1-ConfigServer/","description":"스프링 마이크로 서비스 코딩 공작소","headline":"스프링 클라우드 / Config-Server","dateModified":"2020-08-08T00:00:00+09:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    <script type="text/javascript" src="/assets/js/materialize.min.js"></script>
    <script type="text/javascript" src="/assets/js/main.js"></script>
  </head>
  
  <body style="font-family: 'Noto Sans KR', sans-serif;">
    <header>
      <nav class="top-nav hide-on-large-only">
        <div class="nav-wrapper" style="background-color: #000000; background-image: url('/assets/images/black-felt.png')">
          <div class="container">
            <a class="page-title" href="/">Maymanko's blog</a>
          </div>
        </div>
      </nav>
      <div class="container">
        <a href="#" data-target="slide-out" class="button-collapse top-nav full hide-on-large-only">
          <i class="material-icons">menu</i>
        </a>
      </div>
      <ul id="slide-out" class="sidenav sidenav-fixed" style="background-color: #000000; background-image: url('/assets/images/black-felt.png');">
        <li>
          <h4 class="center-align" style="font-weight: bold;"><a class="white-text page-title" href="/">Maymanko's blog</a></h4>
          <img class="circle z-depth-2 responsive-img" style="display:block; margin-left:auto; margin-right:auto; margin-top:20px; margin-bottom:20px; height:100px;" src="/assets/images/logo.jpeg"/>
        </li>
        
        
          <li>
            <a class="waves-effect" href="/develop" style="color:white;font-size: 1.5em;">
              <i class="material-icons" style="color:white;margin-right:16px;">code</i>
              Develop
                
              
                
                  <span style="font-size: 1.05rem;">(27)</span>
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
            </a>
          </li>
          <ul>
            
              <li>
                <a class="waves-effect" href="/develop/ddd" style="color:white;margin-left:40px;height:30px;line-height: 30px;font-size:1.15em">
                  DDD
                  
                    
                  
                    
                  
                    
                      <span style="font-size: 1.05rem;">(4)</span>
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                </a>
              </li>
            
              <li>
                <a class="waves-effect" href="/develop/msa" style="color:white;margin-left:40px;height:30px;line-height: 30px;font-size:1.15em">
                  MSA
                  
                    
                  
                    
                      <span style="font-size: 1.05rem;">(7)</span>
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                </a>
              </li>
            
              <li>
                <a class="waves-effect" href="/develop/docker" style="color:white;margin-left:40px;height:30px;line-height: 30px;font-size:1.15em">
                  Docker
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                      <span style="font-size: 1.05rem;">(1)</span>
                    
                  
                    
                  
                    
                  
                </a>
              </li>
            
              <li>
                <a class="waves-effect" href="/develop/react" style="color:white;margin-left:40px;height:30px;line-height: 30px;font-size:1.15em">
                  React
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                      <span style="font-size: 1.05rem;">(2)</span>
                    
                  
                    
                  
                    
                  
                    
                  
                </a>
              </li>
            
              <li>
                <a class="waves-effect" href="/develop/typescript" style="color:white;margin-left:40px;height:30px;line-height: 30px;font-size:1.15em">
                  Typescript
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                      <span style="font-size: 1.05rem;">(4)</span>
                    
                  
                </a>
              </li>
            
              <li>
                <a class="waves-effect" href="/develop/electron" style="color:white;margin-left:40px;height:30px;line-height: 30px;font-size:1.15em">
                  Electron
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                      <span style="font-size: 1.05rem;">(1)</span>
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                </a>
              </li>
            
              <li>
                <a class="waves-effect" href="/develop/rabbitmq" style="color:white;margin-left:40px;height:30px;line-height: 30px;font-size:1.15em">
                  RabbitMQ
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                </a>
              </li>
            
              <li>
                <a class="waves-effect" href="/develop/etc" style="color:white;margin-left:40px;height:30px;line-height: 30px;font-size:1.15em">
                  Etc
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                      <span style="font-size: 1.05rem;">(5)</span>
                    
                  
                    
                  
                </a>
              </li>
            
          </ul>
        
          <li>
            <a class="waves-effect" href="/life" style="color:white;font-size: 1.5em;">
              <i class="material-icons" style="color:white;margin-right:16px;">edit</i>
              Life
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
            </a>
          </li>
          <ul>
            
          </ul>
        
          <li>
            <a class="waves-effect" href="/vietnam" style="color:white;font-size: 1.5em;">
              <i class="material-icons" style="color:white;margin-right:16px;">public</i>
              Vietnam
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
            </a>
          </li>
          <ul>
            
          </ul>
        
      </ul>
      
    </header>
    <main>


<div class="container">
  <div id="post-info">
  <h3>스프링 클라우드 / Config-Server</h3>
  
</div>
<div class="divider"></div>
<div class="row">
  <div class="col s12 markdown-body">
    <blockquote>
  <p>스프링 마이크로 서비스 코딩 공작소</p>
</blockquote>

<h1 id="목차">목차</h1>
<h3 id="1장-spring-cloud-config-server">1장 Spring Cloud Config Server</h3>
<h3 id="2장-service-discovery">2장 Service Discovery</h3>
<h3 id="3장-client-recovery-pattern">3장 Client Recovery Pattern</h3>
<h3 id="4장-service-routing">4장 Service Routing</h3>
<h3 id="5장-msa-security">5장 MSA Security</h3>
<h3 id="6장-spring-cloud-stream을-사용한-event-driven-architecture">6장 Spring Cloud Stream을 사용한 Event Driven Architecture</h3>
<h3 id="7장-spring-cloud-slueth와-zipkins를-이용한-분산추적">7장 Spring Cloud Slueth와 Zipkins를 이용한 분산추적</h3>
<h3 id="8장-publishing">8장 Publishing</h3>

<hr />

<h1 id="spring-cloud-config-server">Spring Cloud Config Server</h1>

<h2 id="간단요약">간단요약</h2>
<h4 id="1-spring-cloud-config-server를-사용한-applications-properties를-환경별로-설정-가능">1. Spring Cloud Config Server를 사용한 Application’s properties를 환경별로 설정 가능</h4>
<h4 id="2-spring은-spring-profile을-사용해-spring-cloud-config-service에서-조회할-env-properties를-결정하고-서비스를-시작">2. Spring은 Spring Profile을 사용해 Spring Cloud Config Service에서 조회할 Env Properties를 결정하고 서비스를 시작</h4>
<h4 id="3-spring-cloud-config-services는-file이나-git-기반의-application-저장소를-사용해-application-properties를-저장할-수-있다">3. Spring Cloud Config Services는 file이나 Git 기반의 Application 저장소를 사용해 Application Properties를 저장할 수 있다</h4>
<h4 id="4-spring-cloud-config-service는-대칭-및-비대칭-암호화를-사용해-중요한-정보를-암호화-할-수-있음">4. Spring Cloud Config service는 대칭 및 비대칭 암호화를 사용해 중요한 정보를 암호화 할 수 있음</h4>

<p><br />
<br /></p>

<h2 id="컨피그-서버의-원칙">컨피그 서버의 원칙</h2>
<h4 id="1-분리--서비스-구성정보와-서비스-배포를-분리한다">1. 분리 : 서비스 구성정보와 서비스 배포를 분리한다.</h4>
<h4 id="2-추상화--application이-rest-기반의-json-서비스를-사용해-구성데이터를-조회한다">2. 추상화 : Application이 REST 기반의 JSON 서비스를 사용해 구성데이터를 조회한다.</h4>
<h4 id="3-중앙집중화--application-구성정보를-가능한-소수-저장소에-집중화한다">3. 중앙집중화 : Application 구성정보를 가능한 소수 저장소에 집중화한다.</h4>
<h4 id="4-견고성--application-구성정보-저장소는-어떠한-환경에도-구성-정보를-제공해야-한다">4. 견고성 : Application 구성정보 저장소는 어떠한 환경에도 구성 정보를 제공해야 한다.</h4>

<p><br />
<br /></p>

<h2 id="applicationproperties-구성법">application.properties 구성법</h2>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">server.port</span><span class="pi">:</span> <span class="m">8888</span>
<span class="s">spring.cloud.config.server.git.uri</span><span class="pi">:</span> <span class="s">file//${user.home}/config-repo</span>
<span class="c1">#{user.home}은 git repository</span>
<span class="c1"># window에서는 file:///${user.home}/config-repo로 /추가</span>
</code></pre></div></div>
<h4 id="--실제-서버는-호스팅된-git을-권장">- 실제 서버는 호스팅된 git을 권장</h4>

<p><br />
<br /></p>

<h2 id="환경저장소-environment-repository">환경저장소 (Environment Repository)</h2>

<p><br /></p>

<h4 id="1-environment-객체-구성">1. Environment 객체 구성</h4>
<h5 id="--application---client의-springapplicationname">- {application} &lt;-&gt; Client의 spring.application.name</h5>
<h5 id="--profile---client의-springfilesactive-쉼표로-구분-comma-sepreated-list">- {profile} &lt;-&gt; Client의 spring.files.active (쉼표로 구분, comma-sepreated list)</h5>
<h6 id="-profile이-여러-개일-경우-가장-마지막-것이-적용">* profile이 여러 개일 경우 가장 마지막 것이 적용</h6>
<h5 id="--label---version-정보-등">- {label} &lt;-&gt; version 정보 등</h5>
<h4 id="2-환경저장소는-기본-적으로-git을-사용">2. 환경저장소는 기본 적으로 Git을 사용</h4>

<div class="language-properties highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="py">spring.cloud.config.server.git.uri</span><span class="p">=</span><span class="s">${위치}</span>
<span class="py">spring.cloud.config.server.git.uri</span><span class="p">=</span><span class="s">file:${위치} </span>
<span class="c"># 로컬 git 사용시
</span></code></pre></div></div>
<h6 id="-application-label에-브랜치를-지정할-시---대신-_을-사용">* {application}, {label}에 브랜치를 지정할 시 : ‘/’ 대신 ‘(_)’을 사용</h6>

<p><br /></p>

<h4 id="2-ssl-검증-무시">2. SSL 검증 무시</h4>
<div class="language-properties highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="py">spring.cloud.config.server.git.url</span><span class="p">=</span><span class="s">https://example.com /my/repo</span>
<span class="py">spring.cloud.config.server.git.skipSslValidation</span><span class="p">=</span><span class="s">true</span>
</code></pre></div></div>

<p><br /></p>

<h4 id="3-http-connection-timeout단위--초">3. Http Connection Timeout(단위 : 초)</h4>
<div class="language-properties highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="py">spring.cloud.config.server.git.url</span><span class="p">=</span><span class="s">https://example.com /my/repo</span>
<span class="py">spring.cloud.config.server.git.timout</span><span class="p">=</span><span class="s">4</span>
</code></pre></div></div>

<p><br /></p>

<h4 id="4-다양한-저장소와-매칭">4. 다양한 저장소와 매칭</h4>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">spring</span><span class="pi">:</span>
  <span class="na">cloud</span><span class="pi">:</span>
    <span class="na">config</span><span class="pi">:</span>
      <span class="na">server</span><span class="pi">:</span>
        <span class="na">git</span><span class="pi">:</span>
          <span class="na">uri</span><span class="pi">:</span> <span class="s">https://github.com/spring-cloud-samples/config-repo</span>
          <span class="na">repos</span><span class="pi">:</span>
            <span class="na">simple</span><span class="pi">:</span> <span class="s">https://github.com/simple/config-repo</span>
            <span class="na">special</span><span class="pi">:</span>
              <span class="na">pattern</span><span class="pi">:</span> <span class="s">special*/dev*,*special*/dev*</span>
              <span class="na">uri</span><span class="pi">:</span> <span class="s">https://github.com/special/config-repo</span>
            <span class="na">local</span><span class="pi">:</span>
              <span class="na">pattern</span><span class="pi">:</span> <span class="s">local*</span>
              <span class="na">uri</span><span class="pi">:</span> <span class="s">file:/home/configsvc/config-repo</span>
</code></pre></div></div>
<h6 id="-simple은-simple로-매칭">* simple은 simple/*로 매칭</h6>
<h6 id="-아무-것도-해당되지-않을-경우-springconfigservergituri에서-구성정보-획득">* 아무 것도 해당되지 않을 경우 spring.config.server.git.uri에서 구성정보 획득</h6>

<p><br /></p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">spring</span><span class="pi">:</span>
  <span class="na">cloud</span><span class="pi">:</span>
    <span class="na">config</span><span class="pi">:</span>
      <span class="na">server</span><span class="pi">:</span>
        <span class="na">git</span><span class="pi">:</span>
          <span class="na">uri</span><span class="pi">:</span> <span class="s">https://github.com/spring-cloud-samples/config-repo</span>
          <span class="na">repos</span><span class="pi">:</span>
            <span class="na">development</span><span class="pi">:</span>
              <span class="na">pattern</span><span class="pi">:</span>
                <span class="pi">-</span> <span class="s1">'</span><span class="s">*/development'</span>
                <span class="pi">-</span> <span class="s1">'</span><span class="s">*/staging'</span>
              <span class="na">uri</span><span class="pi">:</span> <span class="s">https://github.com/development/config-repo</span>
            <span class="na">staging</span><span class="pi">:</span>
              <span class="na">pattern</span><span class="pi">:</span>
                <span class="pi">-</span> <span class="s1">'</span><span class="s">*/qa'</span>
                <span class="pi">-</span> <span class="s1">'</span><span class="s">*/production'</span>
              <span class="na">uri</span><span class="pi">:</span> <span class="s">https://github.com/staging/config-repo</span>
</code></pre></div></div>

<p><br /></p>

<h6 id="-저장소-내-폴더-접근시">* 저장소 내 폴더 접근시</h6>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">spring</span><span class="pi">:</span>
  <span class="na">cloud</span><span class="pi">:</span>
    <span class="na">config</span><span class="pi">:</span>
      <span class="na">server</span><span class="pi">:</span>
        <span class="na">git</span><span class="pi">:</span>
          <span class="na">uri</span><span class="pi">:</span> <span class="s">https://github.com/spring-cloud-samples/config-repo</span>
          <span class="na">searchPaths</span><span class="pi">:</span> <span class="s">foo,bar*</span>
</code></pre></div></div>
<h6 id="-저장소-내-foo폴더와-bar-폴더내에서-구성정보를-찾음">* 저장소 내 foo폴더와 bar 폴더내에서 구성정보를 찾음</h6>

<p><br /></p>

<h6 id="-다른-서버에-config-server를-추가시">* 다른 서버에 Config Server를 추가시</h6>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">spring</span><span class="pi">:</span>
  <span class="na">application</span><span class="pi">:</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">configserver</span>
  <span class="na">profiles</span><span class="pi">:</span>
    <span class="na">active</span><span class="pi">:</span> <span class="s">composite</span>
  <span class="na">cloud</span><span class="pi">:</span>
    <span class="na">config</span><span class="pi">:</span>
      <span class="na">server</span><span class="pi">:</span>
        <span class="na">composite</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="na">type</span><span class="pi">:</span> <span class="s">native</span>
            <span class="na">search-locations</span><span class="pi">:</span> <span class="s">${HOME}/Desktop/config</span>
        <span class="na">bootstrap</span><span class="pi">:</span> <span class="no">true</span>
</code></pre></div></div>
<h6 id="-bootstrap이-true일시-bootstrapyml내의-repository-uri에서-구성-정보-획득">* bootstrap이 true일시, bootstrap.yml내의 repository URI에서 구성 정보 획득</h6>

  </div>
</div>
</div>
